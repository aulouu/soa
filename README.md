# SOA Lab 3 - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–æ–¥–∏–Ω —Ä–∞–∑)
```bash
./setup.sh
```

### 2. –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –ó–∞–ø—É—Å–∫ backend (–≤—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã)
./start.sh

# –ó–∞–ø—É—Å–∫ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º (dev —Ä–µ–∂–∏–º)
./start.sh --dev

# –ó–∞–ø—É—Å–∫ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º (production build)
./start.sh --build
```

### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
./start.sh --stop
```

### 4. üÜï –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
./scale.sh status

# –ó–∞–ø—É—Å—Ç–∏—Ç—å 5 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ Service1
./scale.sh service1 5

# –ó–∞–ø—É—Å—Ç–∏—Ç—å 3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ Service2
./scale.sh service2 3

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–∞ —Å–µ—Ä–≤–∏—Å–∞: 4 –∏–Ω—Å—Ç–∞–Ω—Å–∞ Service1 + 6 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ Service2
./scale.sh all 4 6

# –ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ SCALING-GUIDE.md
```

---

## –ß—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç setup.sh

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç Java 11+
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç Maven
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç Consul
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç PostgreSQL –∏ —Å–æ–∑–¥–∞—Å—Ç –±–∞–∑—É `soa_lab3`
- ‚úÖ –°–æ–±–µ—Ä–µ—Ç –≤—Å–µ Maven –ø—Ä–æ–µ–∫—Ç—ã
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç npm –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

---

## –ß—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç start.sh

### Backend (–≤—Å–µ–≥–¥–∞):
1. **Consul** (–ø–æ—Ä—Ç 8500 HTTP) - Service Discovery –¥–ª—è Service1
2. **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
3. **Config Server** (–ø–æ—Ä—Ç 8888 HTTP, internal) - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
4. **Eureka Server** (–ø–æ—Ä—Ç 8761 HTTP, internal) - Service Discovery –¥–ª—è Service2
5. **Zuul Gateway** (–ø–æ—Ä—Ç 8080 HTTPS, public) - API Gateway —Å SSL termination
6. **Service1** (–ø–æ—Ä—Ç 8082 HTTP, internal) - Jakarta EE + EJB + Embedded Tomcat + Consul
7. **Service2** (–ø–æ—Ä—Ç 8081 HTTP, internal) - Spring Cloud + Eureka + Ribbon

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SSL**: Gateway –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç HTTPS —Å–Ω–∞—Ä—É–∂–∏, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è –ø–æ HTTP

### Frontend (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- `--dev` - –∑–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ (npm start)
- `--build` - —Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ production –≤–µ—Ä—Å–∏–∏

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# Consul UI
open http://localhost:8500

# Eureka Dashboard  
open http://localhost:8761

# API —á–µ—Ä–µ–∑ Gateway
curl http://localhost:8080/api/human-beings
curl http://localhost:8080/api/heroes

# Frontend
open http://localhost:3000
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Frontend (:3000)
    ‚Üì
Zuul Gateway (:8080)
    ‚îú‚Üí Service2 (:8081) [Spring Cloud + Eureka + Ribbon]
    ‚îÇ   ‚îî‚Üí Service1 (:8082) [Jakarta EE + EJB + Consul]
    ‚îÇ       ‚îî‚Üí PostgreSQL
    ‚îÇ
    ‚îî‚Üí Service1 (:8082)

–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
- Config Server (:8888)
- Eureka Server (:8761) 
- Consul (:8500)
```

---

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

üéØ **–ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å!** –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω—è–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤:

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `config.env`:
  ```bash
  SERVICE1_INSTANCES=2  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 2 –∏–Ω—Å—Ç–∞–Ω—Å–∞
  SERVICE2_INSTANCES=2  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 2 –∏–Ω—Å—Ç–∞–Ω—Å–∞
  ```

- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ —É—Ç–∏–ª–∏—Ç—É `scale.sh`:
  ```bash
  ./scale.sh service1 5  # –ó–∞–ø—É—Å—Ç–∏—Ç—å 5 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ Service1
  ./scale.sh service2 3  # –ó–∞–ø—É—Å—Ç–∏—Ç—å 3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ Service2
  ./scale.sh status      # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  ```

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤**: –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Ä—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** –≤ Consul (Service1) –∏ Eureka (Service2)
- **Load Balancing** —á–µ—Ä–µ–∑ Zuul Gateway —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ribbon

üìñ **–ü–æ–¥—Ä–æ–±–Ω–µ–µ**: [SCALING-GUIDE.md](./SCALING-GUIDE.md)

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ `config.env`:
- –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ (SERVICE1_INSTANCES, SERVICE2_INSTANCES)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
- SSL (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `config.env`:
```bash
cd scripts && ./generate-configs.sh && cd ..
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 11+
- Maven 3.6+
- PostgreSQL 14
- Node.js 16+ (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
